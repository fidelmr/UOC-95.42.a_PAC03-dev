<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEMO COMPONENT FILTRE BY ME!</title>

    <!-- AREA DE ESTILS QUE CORRESPONDRA ALS TAGS <style> </style> -->
    <style>

    </style>
</head>
<body>
    <!-- AREA DE HTML QUE CORRESPONDRA ALS TAGS <template> </template> -->
    <div class="template">
        <form class="filtre1">
            <fieldset>
                <h3 class="filtreTitol"> FILTRE !!!</h3>
            </fieldset>
            <fieldset>
                <label for="filtreInput">FILTRE </label>
                <input type="text" id="input1" name="filtreInput" placeholder="Posi aqui el text que vulgui comparar amb la entrada"  autocomplete="off">
            </fieldset>
            <fieldset class="filtreRadioButtons">
                <h4>Tria com vols que es faci el cribatge</h4>
                <input type="radio" id="op1" name="options1" value="OP1">
                <label for="op1">Que comenci igual</label><br>
                <input type="radio" id="op2" name="options1" value="OP2">
                <label for="op2">Que contingui el text</label><br>
                <input type="radio" id="op3" name="options1" value="OP3">
                <label for="op3">Que contingui les lletres independents</label>
            </fieldset>
            <!-- SOLS PER EFECTES DE DEBUGGING  INICI -->
            <fieldset>
                ENTRADA: <span id="arrayInput">     </span> <br>
                FILTRE : <span id="filtre1">        </span> <br>
                OPTIONS: <span id="filtre1_options"></span> <br>
                SORTIDA: <span id="arrayOutput">    </span>
            </fieldset>
            <!-- SOLS PER EFECTES DE DEBUGGING  FINAL -->
        </form>
    </div>

    <!-- AREA DE JAVASCRIPT QUE CORRESPONDRA ALS TAGS <script> </script> -->
    <script>

        /* Definim variables de inici */ 
        let ENTRADA = []            // Array amb les paraules que rebem per filtrar
        let SORTIDA = []            // Array amb les paraules que retornem que compleixen el criteri del filtre
        let FILTRE  = ""            // cadena del filtre a aplicar
        let FILTRE_OPTIONS = ""     // Tipus de filtre aplicat

        /* Funcio setup - initialize */
        function filtre_initializer(){
            /**
            * Funcio de setup
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            */
            /* Posem els valors per defecte */ 
            ENTRADA = ["alias", "beto", "Cedric", "Humor", "Atlante", "alita", "Chenoa", "Shakira", "Chewaaka"]
            SORTIDA = []
            FILTRE  = []
            FILTRE_OPTIONS = "OP1"
            /* activem la opcio del op1 .... */ 
            const opcio_op1 = document.querySelector("#op1")
            opcio_op1.checked=true
            /* Mostrem sortida */
            simular_output()
        }

        /* Funcio que simula la sortida enviant els resultats al form */
        function simular_output(){
            /**
            * funcio que simula la sortida de dades
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            */

            const entrada = document.querySelector("span#arrayInput")
            const filtre  = document.querySelector("span#filtre1")
            const opcions = document.querySelector("span#filtre1_options")
            const sortida = document.querySelector("span#arrayOutput")

            entrada.innerHTML = ENTRADA
            filtre.innerHTML  = FILTRE
            opcions.innerHTML = FILTRE_OPTIONS
            sortida.innerHTML = SORTIDA
        }

        /* Funcions de buscar un char en un string */
        function searchCharInString(lletraBuscada,paraulaEntrada){
            /**
            * funcio que busca si un caracter esta contingut en una cadena 
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            * Consultar: https://www.fwait.com/how-to-check-if-string-contains-characters-from-array-in-javascript/
            */
            
            /*
            Val, el primer sera convertir la paraula en un string.
            Despres recorrerem el string comparant amb la lletra, si tenim coincidencia, acabem amb TRUE
                NOTA:   Si fems ervir foreach es molt facil, pero em de recorrer TOTA la praula, si fem servir el FOR 
                        lalvors em de calcular primer la llargada del array pero podrem saltar en qulsevol punt
            Si no tenim cap coincidencia, acabem aamb FALSE
            */ 

            /* Definim les variables locals */
            let resultat0 = false

            /* convertim la paraula de entrada en un string */ 
            paraulaEntrada = paraulaEntrada.split('')

            /* busquem dintre del array */
            paraulaEntrada.forEach(lletraParaula => {
                if(lletraParaula == lletraBuscada){
                    /* Val!!! ja em trobat al menys 1 coincidencia, canviem el resultat a TRUE */
                    resultat0=true; 
                }
            });

            /* retornem el resultat */
            console.log ("FUNCIO: searchCharInString(lletraBuscada,paraulaEntrada)")
            console.log("BUSCAR/ENTRADA/RESULT: ", lletraBuscada, paraulaEntrada, resultat0)
            return resultat0
        }

        function searchCharInStringPositioned(lletraBuscada,paraulaEntrada,posicioLletra){
            /**
            * funcio que busca si un caracter esta contingut en una cadena 
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            * Consultar: https://www.fwait.com/how-to-check-if-string-contains-characters-from-array-in-javascript/
            */

            /* Compliquem la funcio anterior definint qeu el "TRUE" ha de ser en la posicio indicada */

            /* Definim les variables locals */
            let resultat0 = false

            /* convertim la paraula de entrada en un string */ 
            paraulaEntrada = paraulaEntrada.split('')

            /* busquem a la posicio */
            if(paraulaEntrada[posicioLletra] == lletraBuscada) {resultat0 = true}

            /* retornem el resultat */
            console.log ("FUNCIO: searchCharInStringPositioned(lletraBuscada,paraulaEntrada,posicioLletra)")
            console.log("BUSCAR/ENTRADA/POSICIO/RESULT: ", lletraBuscada, paraulaEntrada, posicioLletra,resultat0)
            return resultat0
        }

        /* Funcions de OP1, OP2 i OP3 */
        function op1(cadenaFiltre){/* comença igual que el filtre */}
        function op2(cadenaFiltre){/* inclou el filtre, en algun lloc del nom */}
        function op3(cadenaFiltre){/* inclou les lletres del filtre en qualsevol lloc del nom */}

        function op1V0(){
            /* comença igual que el filtre */
            /* Definim varaibles locals */
            let limitScan = 0
            let resultat0=false
            let sortida0 = []
            let contadorLletres = 0
            let filtre0 = FILTRE
            let paraula0 = ""
            let paraula1 = []
            /* Mirem cuants caracters em de comparar */
            let filtre1 = filtre0.split("")
            let maxCharsTested = filtre0.length
            /* Revisem CADA element de la llista de ENTRADA */ 
            ENTRADA.forEach(paraula0 => {
                /* Convertim la praula del array de entradas en un array .... */
                console.log("COMPARANT FILTRE/PARAULA [" + filtre0 + "] AMB [" + paraula0 + "]")
                paraula1 = paraula0.split('')
                /* Validem quin array es mes lalrg, el filtre o la paraula, per limitar la comparacio  */
                if(maxCharsTested <= paraula1.length){limitScan = maxCharsTested}else{ limitScan = paraula1.length}
                /* I ara mirarem si els chars de la paraula son iguals als del filtre */
                for(let x=0; x<limitScan; x++){
                    /* Comprovem cada lletra valida ... */ 
                    console.log("     COMPARANT " + paraula1[x] + " AMB " + filtre1[x])
                    if (paraula1[x].toLowerCase()==filtre1[x].toLowerCase()) {
                        contadorLletres++
                        console.log("     Letra [" + filtre1[x] + "] aceptada! [" + contadorLletres + "]")
                    } else {
                        console.log("     Letra [" + filtre1[x] + "] DOLENTA! [" + contadorLletres + "]")
                        break
                    }
                }
                // Valeee!!! ... si ara tenim que contadorLletras = maxCharsTested es que la paraula conte el filtre!!!!
                // Per tant, afegim la paraula a la llista de sortida i reinicem contadors ....
                if(contadorLletres == limitScan){
                    console.log("     Paraula " + paraula0 + " aceptada!")
                    sortida0.push(paraula0)
                } else {
                    console.log("     Paraula " + paraula0 + " DOLENTA!")
                }
                contadorLletres = 0
                paraula1 = []
            });
            /* Presentem els resultats: */
            console.log("ENTRADA:  ", ENTRADA)
            console.log("FILTRE :  ", FILTRE)
            console.log("SORTIDA:  ", sortida0)
            SORTIDA = sortida0
            simular_output()
        }

        /* Funcio de filtratge */
        function validar_filtre(){
            /**
            * funcio de filtratge
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            */

            /* Variables locals */ 
            const btnInput = document.querySelector("#input1")
            const opcions  = document.querySelector("span#filtre1_options")          
            /* Recuperem cadena del input */
            FILTRE = btnInput.value
            /* Seleccio principal */
            switch(FILTRE_OPTIONS){
                case ("OP1"):
                    // comença igual que el filtre ;
                    // op1(FILTRE);
                    op1V0()
                    break;
                case ("OP2"):
                    // inclou el filtre ;
                    op2(FILTRE);
                    break;
                case ("OP3"):
                    // inclou lletres del filtre ;
                    op3(FILTRE);
                    break;
                default:
                    //default statement or expression;
                    console.log("Una opcio .... INESPERADA!!!")
            }
            /* retornem resultats */
            console.log("OPCIO ACTIVA -> ", FILTRE_OPTIONS)
            console.log("FILTRATGE    -> ", FILTRE)
            simular_output()
        }

        /* Funcions dels radioBtns */
        function validar_radioBtn(event){
            /**
            * funcio de filtratge
            * @values , @example, @deprecated, @see, @link, @author, @since, @version, @ignore
            */

            const btnInput = document.querySelector("#input1")
            const opcions  = document.querySelectorAll('[name="options1"]')
            console.log(event)
            /* RESET de les dades del INPUT */ 
            btnInput.value=""
            FILTRE_OPTIONS = event.target.attributes.value.value
            event.checked = true
            btnInput.focus()
            simular_output()
        }
                
        /* Asignacio de events als radioButtons */
        const radioBtns = document.querySelectorAll('[name="options1"]')
        radioBtns.forEach(radioBtn => {
            radioBtn.addEventListener("click", validar_radioBtn, false);
        });
        
        /* Asignacio de events al input */
        const input1 = document.querySelector('[name="filtreInput"]')
        input1.addEventListener("keyup", validar_filtre, false);

        /* Asignacio de events al document */
        document.addEventListener("DOMContentLoaded", filtre_initializer, false);

    </script>
</body>
</html>